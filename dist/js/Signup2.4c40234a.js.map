{"version":3,"sources":["webpack:///./src/views/ForClient/Signup2.vue","webpack:///./src/views/ForClient/Signup2.vue?2b6f","webpack:///./src/views/ForClient/Signup2.vue?1d98","webpack:///./src/types/Auth.ts","webpack:///./src/mixins/FormValidator.ts"],"names":["class","stroke-linecap","stroke-linejoin","stroke-width","d","title","router","push","xmlns","fill","viewBox","stroke","ref","onSubmit","formError","label","id","type","required","autocomplete","formData","email","rules","formRequired","disabled","loading","components","setup","remoteToken","getToken","sendSignupEmail","form","setFromError","message","value","window","setTimeout","event","isValid","checkValidity","alert","data","is_send","name","params","console","log","response","status","JSON","stringify","render","getUUID","get","post","activateAccount","token","registerProfile","registrationUrl","formDataCopy","address","street","building","put","localStorage","getItem","parse","createToken","postData","storeToken","setItem","removeItem","getUserId","getProfile","userId","signup","useAuth","v","getRegexpTester","pattern","errorMessage","test"],"mappings":"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","file":"js/Signup2.4c40234a.js","sourcesContent":["<template>\n  <top-layout>\n    <template v-slot:title>\n      <div class=\"relative\">\n        <svg\n          @click=\"() => { router.push({ name: 'Signup1' }) }\"\n          class=\"absolute top-0 left-0 w-10 h-10 cursor-pointer\"\n          xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n          <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M15 19l-7-7 7-7\" />\n        </svg>\n        <div class=\"\">\n          新規登録\n        </div>\n      </div>\n    </template>\n    <div class=\"grid grid-cols-12\">\n      <form\n        ref=\"form\"\n        class=\"py-5 col-span-12 sm:col-span-6 sm:col-start-4 md:col-span-4 md:col-start-5 p-5\"\n        @submit.prevent=\"onSubmit\"\n      >\n        <div\n          v-if=\"formError != ''\"\n          class=\"mb-5 text-red-600\"\n        >\n          {{ formError }}\n        </div>\n        <p-input\n          class=\"mb-10\"\n          label=\"メールアドレス\"\n          id=\"email\"\n          type=\"email\"\n          :required=\"true\"\n          autocomplete=\"email\"\n          v-model=\"formData.email\"\n          :rules=\"[formRequired]\"\n        >\n        </p-input>\n        \n        \n        <div\n          class=\"text-center\"\n        >\n          <button\n            :disabled=\"loading\"\n            type=\"submit\"\n            class=\"primary arrow w-64 mb-10\"\n          >\n            確認メールを送信\n            \n          </button>\n          <div>\n            <a class=\"cursor-pointer \">確認メールが届かない場合は？</a>\n          </div>\n        </div>\n      </form>\n    </div>\n  </top-layout>\n</template>\n<script lang=\"ts\">\nimport { defineComponent, onMounted, ref,  } from 'vue';\nimport { useRouter } from 'vue-router';\nimport { ILogin, ISignup } from '@/types/Interfaces';\nimport {formRequired} from '@/mixins/FormValidator';\n\nimport useAuth from '@/types/Auth';\n\nexport default defineComponent({\n  components: {\n  },\n  setup() {\n    const router = useRouter();\n    \n    const {\n      getToken,\n      remoteToken,\n      sendSignupEmail\n    } = useAuth();\n\n    const formData = ref({\n      email: '',\n    });\n    \n    const form = ref<HTMLFormElement | null>(null);\n\n    const formError = ref<string>('');\n    \n    const setFromError = (message: string) => {\n      formError.value = message;\n      window.setTimeout(() => {\n        formError.value = '';\n      }, 5000);  \n    };\n    \n    onMounted(() => {\n      remoteToken();\n    });\n\n    const loading = ref(false);\n\n    const onSubmit = async (event: Event) => {\n      // validate\n      if (form.value) {\n        const isValid = form.value.checkValidity();\n        if (!isValid) {\n          alert('not vaida')\n          return;\n        }\n      }\n      try {\n        loading.value = true;\n        const data = await sendSignupEmail(formData.value);\n        if (data.is_send) {\n          router.push({ name: 'Signup3', params: { email: formData.value.email } });  \n        } else {\n          alert(data.message)\n        }\n      } catch (err) {\n        console.log(err)\n        if (err.response) {\n          const { status, data } = err.response;\n          console.log(data)\n         \n          setFromError(JSON.stringify(data))\n         \n        } else {\n          setFromError('ネットワークエラー')\n        }\n        \n      }\n      loading.value = false;\n      \n    };\n    return {\n      router,\n      loading,\n      form,\n      formRequired,\n      formData,\n      formError,\n      // formValid,\n      onSubmit\n    };\n  }\n})\n</script>","\nimport { defineComponent, onMounted, ref,  } from 'vue';\nimport { useRouter } from 'vue-router';\nimport { ILogin, ISignup } from '@/types/Interfaces';\nimport {formRequired} from '@/mixins/FormValidator';\n\nimport useAuth from '@/types/Auth';\n\nexport default defineComponent({\n  components: {\n  },\n  setup() {\n    const router = useRouter();\n    \n    const {\n      getToken,\n      remoteToken,\n      sendSignupEmail\n    } = useAuth();\n\n    const formData = ref({\n      email: '',\n    });\n    \n    const form = ref<HTMLFormElement | null>(null);\n\n    const formError = ref<string>('');\n    \n    const setFromError = (message: string) => {\n      formError.value = message;\n      window.setTimeout(() => {\n        formError.value = '';\n      }, 5000);  \n    };\n    \n    onMounted(() => {\n      remoteToken();\n    });\n\n    const loading = ref(false);\n\n    const onSubmit = async (event: Event) => {\n      // validate\n      if (form.value) {\n        const isValid = form.value.checkValidity();\n        if (!isValid) {\n          alert('not vaida')\n          return;\n        }\n      }\n      try {\n        loading.value = true;\n        const data = await sendSignupEmail(formData.value);\n        if (data.is_send) {\n          router.push({ name: 'Signup3', params: { email: formData.value.email } });  \n        } else {\n          alert(data.message)\n        }\n      } catch (err) {\n        console.log(err)\n        if (err.response) {\n          const { status, data } = err.response;\n          console.log(data)\n         \n          setFromError(JSON.stringify(data))\n         \n        } else {\n          setFromError('ネットワークエラー')\n        }\n        \n      }\n      loading.value = false;\n      \n    };\n    return {\n      router,\n      loading,\n      form,\n      formRequired,\n      formData,\n      formError,\n      // formValid,\n      onSubmit\n    };\n  }\n})\n","import { render } from \"./Signup2.vue?vue&type=template&id=4a7368dd\"\nimport script from \"./Signup2.vue?vue&type=script&lang=ts\"\nexport * from \"./Signup2.vue?vue&type=script&lang=ts\"\nscript.render = render\n\nexport default script","import { client } from '@/types/Axios';\nimport { ILogin, ISignup, ICustomer, IPrescript, IToken, IRegistration } from '@/types/Interfaces';\nimport { computed, ComputedRef, WritableComputedRef } from 'vue';\nimport { cloneDeep, clone, runInContext } from \"lodash\";\n\n// const token: WritableComputedRef<IToken | null> = computed({\n//   get: () => {\n//     const token = window.localStorage.getItem('token');\n//     if (token == null) return null;\n//     return JSON.parse(token);\n//   },\n//   set: (data: IToken | null) => {\n//     if (data == null) {\n//       window.localStorage.removeItem('token');\n//       return;\n//     }\n//     window.localStorage.setItem('token', JSON.stringify(data))\n//   }  \n// });\n\n\nconst getUUID = async () => {\n  const {data} = await client.get('/uuid/')\n  console.log(data)\n  return data;\n}\n\nconst sendSignupEmail = async (formData: any) => {\n  const {data} = await client.post('/customer_pre_create/', formData);\n  console.log(data);\n  return data;  \n};\nconst activateAccount = async (token: string) => {\n  const {data} = await client.get(`/customer_activator/${token}`);\n  console.log(data)\n  return data;  \n};\nconst registerProfile = async (registrationUrl: string, formData: IRegistration) => {\n  const formDataCopy = cloneDeep(formData);\n  \n  formDataCopy.address = `${formDataCopy.street}${formDataCopy.building}`;\n  delete formDataCopy.street;\n  delete formDataCopy.building;\n  const {data} = await client.put(registrationUrl, formDataCopy);\n  console.log(data)\n  return data;\n}\n\nconst getToken = () => {\n  const d = window.localStorage.getItem('token')\n  if (d == null) return;\n  return JSON.parse(d);\n}\nconst createToken = async (postData: ILogin) => {\n  const {data} = await client.post('/auth/jwt/create/', postData);\n  // console.log(data)\n  return data;\n  // window.localStorage.setItem('token', JSON.stringify(data));    \n};\n\nconst storeToken = (token: IToken) => {\n  window.localStorage.setItem('token', JSON.stringify(token))\n}\n\nconst remoteToken = () => {\n  window.localStorage.removeItem('token');\n};\n\nconst getUserId = async () => {\n  const {data} = await client.get('/auth/users/me/')\n  return data.id;\n};\n\nconst getProfile = async (userId: number) => {\n  const {data} = await client.get(`/auth/users/${userId}/`);\n  console.log(data)\n  return data;\n};\n\n\nconst signup = async (postData: ISignup) => {\n  const { data } = await client.post(\n    `/signup/`, postData\n  );\n};\n\n\n\nexport default function useAuth () {\n  return {\n    sendSignupEmail,\n    activateAccount,\n    registerProfile,\n    createToken,\n    storeToken,\n    getToken,\n    remoteToken,\n    getUserId,\n    getProfile,\n    signup,\n    getUUID\n  }\n}","\nconst required = (v: any) => {\n  if (typeof v === 'string') {\n    return v ? null : '必須項目です。'\n  }\n};\nconst getRegexpTester = (pattern: RegExp, errorMessage: string) => {\n  return (v: any) => {\n    return pattern.test(v) ? null : errorMessage;\n  }\n}\n\nexport {\n  required as formRequired,\n  getRegexpTester\n}"],"sourceRoot":""}