{"version":3,"sources":["webpack:///./src/views/ForDoctor/Login.vue?4aba","webpack:///./node_modules/core-js/modules/es.object.entries.js","webpack:///./src/assets/img/doctor/pesod_logo_doctor.png","webpack:///./node_modules/core-js/internals/object-to-array.js","webpack:///./node_modules/core-js/modules/es.array.map.js","webpack:///./src/views/ForDoctor/Login.vue","webpack:///./node_modules/@babel/runtime/helpers/esm/arrayWithHoles.js","webpack:///./node_modules/@babel/runtime/helpers/esm/iterableToArrayLimit.js","webpack:///./node_modules/@babel/runtime/helpers/esm/nonIterableRest.js","webpack:///./node_modules/@babel/runtime/helpers/esm/slicedToArray.js","webpack:///./src/mixins/FormValidator.ts","webpack:///./src/types/Doctor.ts","webpack:///./src/views/ForDoctor/Login.vue?426c","webpack:///./src/views/ForDoctor/Login.vue?d2ba"],"names":["$","$entries","entries","target","stat","O","module","exports","DESCRIPTORS","objectKeys","toIndexedObject","propertyIsEnumerable","f","createMethod","TO_ENTRIES","it","key","keys","length","i","result","call","push","values","$map","map","arrayMethodHasSpeciesSupport","HAS_SPECIES_SUPPORT","proto","forced","callbackfn","this","arguments","undefined","class","src","alt","xmlns","viewBox","fill","fill-rule","d","clip-rule","disabled","loading","ref","method","onLogin","loginError","label","id","type","required","autocomplete","formData","email","placeholder","error","errors","isPasswordHidden","password","hidable","isHidden","_arrayWithHoles","arr","Array","isArray","_iterableToArrayLimit","_i","Symbol","iterator","_s","_e","_arr","_n","_d","next","done","value","err","_nonIterableRest","TypeError","_slicedToArray","arrayWithHoles","iterableToArrayLimit","unsupportedIterableToArray","nonIterableRest","v","getRegexpTester","pattern","errorMessage","test","emailValidator","data","validators","hasError","Object","fieldError","e","useDoctors","client","doctors","doctor","fetchDoctors","get","getDoctor","components","setup","router","createToken","storeToken","removeToken","getUserId","storeProfile","getProfile","removeProfile","getProfileFromLS","form","setLoginError","message","window","setTimeout","event","token","console","log","access","userId","profile","name","response","status","JSON","stringify","formRequired","render","__scopeId"],"mappings":"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","file":"js/chunk-54b3b3a3.ee8638ad.js","sourcesContent":["export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./Login.vue?vue&type=style&index=0&id=83d8b45e&scoped=true&lang=css\"","var $ = require('../internals/export');\nvar $entries = require('../internals/object-to-array').entries;\n\n// `Object.entries` method\n// https://tc39.es/ecma262/#sec-object.entries\n$({ target: 'Object', stat: true }, {\n  entries: function entries(O) {\n    return $entries(O);\n  }\n});\n","module.exports = __webpack_public_path__ + \"img/pesod_logo_doctor.dad27519.png\";","var DESCRIPTORS = require('../internals/descriptors');\nvar objectKeys = require('../internals/object-keys');\nvar toIndexedObject = require('../internals/to-indexed-object');\nvar propertyIsEnumerable = require('../internals/object-property-is-enumerable').f;\n\n// `Object.{ entries, values }` methods implementation\nvar createMethod = function (TO_ENTRIES) {\n  return function (it) {\n    var O = toIndexedObject(it);\n    var keys = objectKeys(O);\n    var length = keys.length;\n    var i = 0;\n    var result = [];\n    var key;\n    while (length > i) {\n      key = keys[i++];\n      if (!DESCRIPTORS || propertyIsEnumerable.call(O, key)) {\n        result.push(TO_ENTRIES ? [key, O[key]] : O[key]);\n      }\n    }\n    return result;\n  };\n};\n\nmodule.exports = {\n  // `Object.entries` method\n  // https://tc39.es/ecma262/#sec-object.entries\n  entries: createMethod(true),\n  // `Object.values` method\n  // https://tc39.es/ecma262/#sec-object.values\n  values: createMethod(false)\n};\n","'use strict';\nvar $ = require('../internals/export');\nvar $map = require('../internals/array-iteration').map;\nvar arrayMethodHasSpeciesSupport = require('../internals/array-method-has-species-support');\n\nvar HAS_SPECIES_SUPPORT = arrayMethodHasSpeciesSupport('map');\n\n// `Array.prototype.map` method\n// https://tc39.es/ecma262/#sec-array.prototype.map\n// with adding support of @@species\n$({ target: 'Array', proto: true, forced: !HAS_SPECIES_SUPPORT }, {\n  map: function map(callbackfn /* , thisArg */) {\n    return $map(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n","<template>\n  \n  <div class=\"bg-image h-screen w-screen table-cell align-middle\">\n    <div class=\"mx-auto rounded p-5 w-80\">\n      <img\n        src=\"@/assets/img/doctor/pesod_logo_doctor.png\"\n        alt=\"\"\n        class=\"mb-5\"\n      >\n      <form\n        class=\" \"\n        :disabled=\"loading\"\n        ref=\"from\"\n        method=\"post\"\n        @submit.prevent=\"onLogin\"\n      >\n        <div\n        v-if=\"loginError != ''\"\n        class=\"mb-5 text-red-600\"\n      >\n        {{ loginError }}\n      </div>\n      <p-input\n        class=\"mb-10\"\n        label=\"メールアドレス\"\n        id=\"email\"\n        type=\"email\"\n        :required=\"true\"\n        autocomplete=\"email\"\n        v-model=\"formData.email\"\n        placeholder=\"example@pesod.com\"\n        :error=\"errors.email\"\n      >\n      </p-input>\n      \n      <p-input\n        class=\"mb-12\"\n        label=\"パスワード\"\n        autocomplete=\"current-password\"\n        id=\"password\"\n        :type=\"isPasswordHidden ? 'password' : 'text'\"\n        v-model=\"formData.password\"\n        :hidable=\"true\"\n        v-model:isHidden=\"isPasswordHidden\"\n        placeholder=\"英数字8文字以上で入力\"\n        :error=\"errors.password\"\n      >\n      </p-input>\n      \n      \n      <div\n        class=\"text-center\"\n      >\n        <button\n          :disabled=\"loading\"\n          type=\"submit\"\n          class=\"primary mb-10 w-72 sm:block sm:w-full\"\n        >\n          <div class=\"inline-block\">\n            ログイン\n          </div>\n          <svg\n          class=\" w-6 h-6 float-right\"\n          xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\n            <path fill-rule=\"evenodd\" d=\"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z\" clip-rule=\"evenodd\" />\n          </svg>\n        </button>\n        <div>\n          <a class=\"cursor-pointer \">パスワードをお忘れの方はこちら</a>\n        </div>\n      </div>\n      </form>\n    </div>\n    \n  </div>\n</template>\n<style scoped>\n  .bg-image {\n    background-image: url(/img/top_bk_PC.png);\n    background-size: contain;\n  }\n</style>\n<script lang=\"ts\">\nimport { defineComponent, ref, Ref, onMounted, isProxy } from 'vue';\nimport { useRoute, useRouter } from 'vue-router';\nimport { ILogin } from '@/types/Interfaces';\n\nimport {formRequired, emailValidator, validate} from '@/mixins/FormValidator';\n\nimport useAuth from '@/types/Auth';\nimport useDoctor from '@/types/Doctor';\nimport { remove } from 'lodash';\n\nexport default defineComponent({\n  components: {\n  },\n  setup() {\n    const router = useRouter();\n    \n    const {\n      createToken,\n      storeToken,\n      removeToken,\n      getUserId,\n      getProfile,\n      storeProfile,\n      removeProfile,\n      getProfileFromLS\n    } = useAuth();\n    \n    const {\n      getDoctor\n    } = useDoctor();\n\n    const formData = ref<ILogin>({\n      email: '',\n      password: '' \n    });\n    \n    const errors: Ref<{ [key: string]: string }> = ref({\n      email: '',\n      password: ''  \n    });\n\n    const validators: { [key: string]: Function[] } = {\n      email: [\n        formRequired,\n        emailValidator\n      ],\n      password: [\n        formRequired\n      ]\n    }\n    \n    \n    const form = ref<HTMLFormElement | null>(null);\n\n    const loginError = ref<string>('');\n    \n    const setLoginError = (message: string) => {\n      loginError.value = message;\n      window.setTimeout(() => {\n        loginError.value = '';\n      }, 5000);  \n    };\n    \n    onMounted(() => {\n      removeToken()\n    });\n\n    const loading = ref(false);\n\n    const onLogin = async (event: Event) => {\n      // validate\n      // if (form.value) {\n      //   const isValid = form.value.checkValidity();\n      //   if (!isValid) {\n      //     alert('not vaida')\n      //     return;\n      //   }\n      // }\n      if (!validate(formData.value, validators, errors)) return;\n      \n      try {\n        loading.value = true;\n        const token = await createToken(formData.value);\n        storeToken(token);\n        console.log(token.access)\n        const userId = await getUserId();\n        const profile = await getDoctor(userId)\n        console.log(profile)\n        storeProfile(profile)\n        router.push({ name: 'DoctorDashboard' }) ;\n      } catch (err) {\n        console.log(err)\n        if (err.response) {\n          const { status, data } = err.response;\n          console.log(data)\n          if (status >= 400 && status < 500) {\n            setLoginError('ログインに失敗しました。')\n          } else {\n            setLoginError(JSON.stringify(data))\n          }\n          // formData.value = {\n          //   email: '',\n          //   password: ''\n          // }\n        } else {\n          // network error or timeout\n          setLoginError('ネットワークエラー')\n        }\n        \n      }\n      loading.value = false;\n      \n    };\n    const isPasswordHidden = ref(true);\n    return {\n      loading,\n      form,\n      formRequired,\n      formData,\n      loginError,\n      // formValid,\n      onLogin,\n      isPasswordHidden,\n      errors, \n    };\n  }\n})\n</script>","export default function _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}","export default function _iterableToArrayLimit(arr, i) {\n  var _i = arr && (typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"]);\n\n  if (_i == null) return;\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n\n  var _s, _e;\n\n  try {\n    for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}","export default function _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}","import arrayWithHoles from \"./arrayWithHoles.js\";\nimport iterableToArrayLimit from \"./iterableToArrayLimit.js\";\nimport unsupportedIterableToArray from \"./unsupportedIterableToArray.js\";\nimport nonIterableRest from \"./nonIterableRest.js\";\nexport default function _slicedToArray(arr, i) {\n  return arrayWithHoles(arr) || iterableToArrayLimit(arr, i) || unsupportedIterableToArray(arr, i) || nonIterableRest();\n}","import { Ref } from \"@vue/reactivity\";\n\nconst required = (v: any) => {\n  if (typeof v === 'string') {\n    return v ? null : '必須項目です。'\n  }\n};\nconst getRegexpTester = (pattern: RegExp, errorMessage: string) => {\n  return (v: any) => {\n    return pattern.test(v) ? null : errorMessage;\n  }\n}\n\nconst emailValidator = (v: string) => {\n  return getRegexpTester(/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\\.[a-zA-Z0-9-]+)*$/, 'メールアドレスの形式が不正です。')(v)\n}\n\nconst validate = (data: { [key: string]: any }, validators: { [key: string]: Function[] }, errors: Ref<{ [key: string]: string }>) => {\n  let hasError = false;\n  Object.entries(validators).map(([key, validators]) => {\n    let fieldError = '';\n    errors.value[key] = '';\n    validators.map((v: Function) => {\n      if (fieldError) return;\n\n      const e = v(data[key]);\n      if (e) {\n        fieldError = e;\n        hasError = true;\n      }\n    });\n    \n    if (fieldError) errors.value[key] = fieldError;\n  });\n  return !hasError;\n}\n\nexport {\n  required as formRequired,\n  emailValidator,\n  getRegexpTester,\n  validate\n}","import { ref, computed } from 'vue';\nimport { IDoctor } from './Interfaces';\nimport useAxios from './Axios';\n\n\n\n\n// const myDoctor = computed(() => {\n//   return doctors.value.find(d => d.id===1);\n// })\nexport default function useDoctors() {\n  const {\n    client\n  } = useAxios()\n\n  const doctors = ref<IDoctor[]>([]);\n  const doctor = ref<IDoctor | null>(null);\n  \n  const fetchDoctors = async (): Promise<IDoctor[]> => {\n    const { data } = await client.get('/doctors/');\n    return data\n  }\n  \n  const getDoctor = async (id: number): Promise<IDoctor> => {\n    const { data } = await client.get(`/doctor/${id}`);\n    return data;\n  }\n  return {\n    // myDoctor,\n    doctor,\n    doctors,\n    getDoctor,\n    fetchDoctors\n  }\n}","\nimport { defineComponent, ref, Ref, onMounted, isProxy } from 'vue';\nimport { useRoute, useRouter } from 'vue-router';\nimport { ILogin } from '@/types/Interfaces';\n\nimport {formRequired, emailValidator, validate} from '@/mixins/FormValidator';\n\nimport useAuth from '@/types/Auth';\nimport useDoctor from '@/types/Doctor';\nimport { remove } from 'lodash';\n\nexport default defineComponent({\n  components: {\n  },\n  setup() {\n    const router = useRouter();\n    \n    const {\n      createToken,\n      storeToken,\n      removeToken,\n      getUserId,\n      getProfile,\n      storeProfile,\n      removeProfile,\n      getProfileFromLS\n    } = useAuth();\n    \n    const {\n      getDoctor\n    } = useDoctor();\n\n    const formData = ref<ILogin>({\n      email: '',\n      password: '' \n    });\n    \n    const errors: Ref<{ [key: string]: string }> = ref({\n      email: '',\n      password: ''  \n    });\n\n    const validators: { [key: string]: Function[] } = {\n      email: [\n        formRequired,\n        emailValidator\n      ],\n      password: [\n        formRequired\n      ]\n    }\n    \n    \n    const form = ref<HTMLFormElement | null>(null);\n\n    const loginError = ref<string>('');\n    \n    const setLoginError = (message: string) => {\n      loginError.value = message;\n      window.setTimeout(() => {\n        loginError.value = '';\n      }, 5000);  \n    };\n    \n    onMounted(() => {\n      removeToken()\n    });\n\n    const loading = ref(false);\n\n    const onLogin = async (event: Event) => {\n      // validate\n      // if (form.value) {\n      //   const isValid = form.value.checkValidity();\n      //   if (!isValid) {\n      //     alert('not vaida')\n      //     return;\n      //   }\n      // }\n      if (!validate(formData.value, validators, errors)) return;\n      \n      try {\n        loading.value = true;\n        const token = await createToken(formData.value);\n        storeToken(token);\n        console.log(token.access)\n        const userId = await getUserId();\n        const profile = await getDoctor(userId)\n        console.log(profile)\n        storeProfile(profile)\n        router.push({ name: 'DoctorDashboard' }) ;\n      } catch (err) {\n        console.log(err)\n        if (err.response) {\n          const { status, data } = err.response;\n          console.log(data)\n          if (status >= 400 && status < 500) {\n            setLoginError('ログインに失敗しました。')\n          } else {\n            setLoginError(JSON.stringify(data))\n          }\n          // formData.value = {\n          //   email: '',\n          //   password: ''\n          // }\n        } else {\n          // network error or timeout\n          setLoginError('ネットワークエラー')\n        }\n        \n      }\n      loading.value = false;\n      \n    };\n    const isPasswordHidden = ref(true);\n    return {\n      loading,\n      form,\n      formRequired,\n      formData,\n      loginError,\n      // formValid,\n      onLogin,\n      isPasswordHidden,\n      errors, \n    };\n  }\n})\n","import { render } from \"./Login.vue?vue&type=template&id=83d8b45e&scoped=true\"\nimport script from \"./Login.vue?vue&type=script&lang=ts\"\nexport * from \"./Login.vue?vue&type=script&lang=ts\"\n\nimport \"./Login.vue?vue&type=style&index=0&id=83d8b45e&scoped=true&lang=css\"\nscript.render = render\nscript.__scopeId = \"data-v-83d8b45e\"\n\nexport default script"],"sourceRoot":""}