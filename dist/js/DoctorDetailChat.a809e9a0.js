(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["DoctorDetailChat"],{"52e6":function(e,t,c){"use strict";c("b0c0");var r=c("7a23"),a={class:"flex items-center px-3 py-2 hover:bg-gray-100"},n={key:0},s={class:"flex-grow text-left ml-2"},o=Object(r["h"])("path",{"fill-rule":"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z","clip-rule":"evenodd"},null,-1);function l(e,t,c,l,u,i){var d=Object(r["B"])("p-checkbox");return Object(r["t"])(),Object(r["d"])("div",a,[e.isSelectable?(Object(r["t"])(),Object(r["d"])("div",n,[Object(r["h"])(d,{modelValue:e.inCart,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.onCheck(t)})},null,8,["modelValue"])])):Object(r["e"])("",!0),Object(r["h"])("div",null,[Object(r["h"])("img",{src:e.product.image,alt:"",style:{width:"50px",height:"50px"}},null,8,["src"])]),Object(r["h"])("div",s,[Object(r["h"])("div",null,Object(r["D"])(e.product.name),1),Object(r["h"])("div",null,Object(r["D"])((e.product.price||0).toLocaleString())+"円 ",1)]),Object(r["h"])("div",null,[e.isSelectable?(Object(r["t"])(),Object(r["d"])("svg",{key:0,onClick:t[2]||(t[2]=function(){e.router.push({name:"StoreProductDetail",params:{id:e.product.id}})}),class:"w-8 h-8 inline-block cursor-pointer",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[o])):Object(r["e"])("",!0)])])}var u=c("6c02"),i=Object(r["i"])({components:{},emits:["update:inCart"],props:{product:{type:Object},inCart:{type:Boolean},isSelectable:{type:Boolean,default:!0}},setup:function(e,t){var c=Object(u["d"])(),r=function(e){console.log(e),t.emit("update:inCart",e)};return{router:c,onCheck:r}}});i.render=l;t["a"]=i},"53f3":function(e,t,c){"use strict";c.r(t);var r=c("7a23"),a=Object(r["K"])("data-v-2fc66ddb");Object(r["w"])("data-v-2fc66ddb");var n={class:"flex items-center"},s=Object(r["h"])("div",null,"診察室",-1),o={class:"flex items-center text-sm ml-2"},l=Object(r["h"])("div",null,"[",-1),u={key:1,style:{height:"30px",width:"30px"},xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},i=Object(r["h"])("path",{"fill-rule":"evenodd",d:"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z","clip-rule":"evenodd"},null,-1),d={class:"px-2"},b=Object(r["h"])("div",null,"]",-1),p={ref:"messageArea",class:"relative overflow-y-auto flex-grow pt-1"},O={class:"absolute w-full space-y-4 pb-5"},j={key:0,class:"date flex"},h={key:0,class:"date flex"},v={key:1,class:"px-2"},f=Object(r["h"])("div",{class:"bg-blue-400 text-white"}," 処方提案を受けています ",-1),g={class:"flex items-center"},m=Object(r["h"])("button",{class:"bg-gray-200 ml-2"}," 拒否 ",-1),w=Object(r["h"])("div",null,"テンプレート",-1),y={key:0,class:"h-4 w-4",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},x=Object(r["h"])("path",{"fill-rule":"evenodd",d:"M14.707 12.707a1 1 0 01-1.414 0L10 9.414l-3.293 3.293a1 1 0 01-1.414-1.414l4-4a1 1 0 011.414 0l4 4a1 1 0 010 1.414z","clip-rule":"evenodd"},null,-1),k={key:1,class:"h-4 w-4",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},S=Object(r["h"])("path",{"fill-rule":"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z","clip-rule":"evenodd"},null,-1),D={key:0,style:{height:"100px"},class:"relative overflow-y-scroll"},M={key:0,class:"absolute w-full"},C={key:1};Object(r["u"])();var P=a((function(e,t,c,P,L,_){var B=Object(r["B"])("ws-state-marker"),T=Object(r["B"])("page-title"),R=Object(r["B"])("chat-message-card"),z=Object(r["B"])("product-list-card"),A=Object(r["B"])("chat-form"),V=Object(r["B"])("base-layout");return e.myPrescript?(Object(r["t"])(),Object(r["d"])(V,{key:0},{title:a((function(){return[Object(r["h"])(T,null,{default:a((function(){return[Object(r["h"])("div",n,[s,Object(r["h"])("div",o,[l,e.doctor.image?(Object(r["t"])(),Object(r["d"])("img",{key:0,src:e.doctor.image,alt:"doctor",style:{height:"30px",width:"30px"}},null,8,["src"])):(Object(r["t"])(),Object(r["d"])("svg",u,[i])),Object(r["h"])("div",d,Object(r["D"])(e.doctor.first_name)+" "+Object(r["D"])(e.doctor.last_name),1),b])]),Object(r["h"])(B,{wsState:e.wsState},null,8,["wsState"])]})),_:1})]})),default:a((function(){return[Object(r["h"])("div",p,[Object(r["h"])("div",O,[e.chatLogs.length>0?(Object(r["t"])(),Object(r["d"])("div",j,Object(r["D"])(e.getDate(e.chatLogs[0].created_at)),1)):Object(r["e"])("",!0),(Object(r["t"])(!0),Object(r["d"])(r["a"],null,Object(r["z"])(e.chatLogs,(function(t,c){return Object(r["t"])(),Object(r["d"])(r["a"],{key:c},[c>1&&e.getDate(e.chatLogs[c].created_at)!==e.getDate(e.chatLogs[c-1].created_at)?(Object(r["t"])(),Object(r["d"])("div",h,Object(r["D"])(e.getDate(t.created_at)),1)):Object(r["e"])("",!0),Object(r["h"])(R,{chatLog:t,isMyMessage:t.speaker===e.myPrescript.customer.id},null,8,["chatLog","isMyMessage"])],64)})),128)),e.myPrescript.prescript_products.length?(Object(r["t"])(),Object(r["d"])("div",v,[f,(Object(r["t"])(!0),Object(r["d"])(r["a"],null,Object(r["z"])(e.myPrescript.prescript_products,(function(e,t){return Object(r["t"])(),Object(r["d"])(z,{key:t,product:e,isSelectable:!1},null,8,["product"])})),128)),Object(r["h"])("div",g,[Object(r["h"])("button",{onClick:t[1]||(t[1]=function(){return e.onAcceptPrescriptProducts&&e.onAcceptPrescriptProducts.apply(e,arguments)}),class:"bg-blue-400 text-white "}," 承諾 "),m])])):Object(r["e"])("",!0)])],512),Object(r["h"])(A,{modelValue:e.message,"onUpdate:modelValue":t[3]||(t[3]=function(t){return e.message=t}),onSend:e.onSendMessage},{menu:a((function(){return[Object(r["h"])("button",{onClick:t[2]||(t[2]=function(t){return e.showMessageTemplates=!e.showMessageTemplates}),class:"border rounded-lg py-1 text-sm flex items-center"},[w,e.showMessageTemplates?(Object(r["t"])(),Object(r["d"])("svg",k,[S])):(Object(r["t"])(),Object(r["d"])("svg",y,[x]))])]})),_:1},8,["modelValue","onSend"]),e.showMessageTemplates?(Object(r["t"])(),Object(r["d"])("div",D,[e.customerMessageTemplates.length?(Object(r["t"])(),Object(r["d"])("ul",M,[(Object(r["t"])(!0),Object(r["d"])(r["a"],null,Object(r["z"])(e.customerMessageTemplates,(function(t,c){return Object(r["t"])(),Object(r["d"])("li",{onClick:function(c){return e.onSelectTemplate(t)},key:c,class:"border-b border-gray-100 hover:bg-gray-50"},Object(r["D"])(t.message),9,["onClick"])})),128))])):(Object(r["t"])(),Object(r["d"])("div",C," テンプレートがありません。 "))])):Object(r["e"])("",!0)]})),_:1})):Object(r["e"])("",!0)})),L=(c("99af"),c("caad"),c("ac1f"),c("2532"),c("5319"),c("498a"),c("96cf"),c("1da1")),_=c("6c02"),B=c("472c"),T=c("8f75"),R=c("6834"),z=c("e59e"),A=c("0b48"),V=c("da56"),J=c("382a"),U=c("feb7"),W=c("c1df"),E=c.n(W),N=c("52e6"),q=Object(r["i"])({components:{ChatMessageCard:z["a"],ChatForm:A["a"],WsStateMarker:U["a"],ProductListCard:N["a"]},props:{doctor:{type:Object}},setup:function(e,t){Object(_["c"])();var c=Object(_["d"])(),a=Object(J["a"])(),n=a.token,s=Object(V["a"])(),o=s.myPrescript,l=s.getPrescript,u=s.acceptPrescriptProducts,i=Object(T["a"])(),d=(i.doctors,i.fetchDoctors,Object(B["a"])()),b=d.chatLogs,p=d.fetchDoctorChatLogs,O=d.fetchCustomerMessageTemplates,j=Object(R["a"])(),h=j.WS_BASE_URL,v=j.connection,f=(j.connect,j.close),g=j.messageArea,m=j.scrollDown,w=j.wsState,y=j.wsStateStr,x=j.message,k=j.prepareWs,S=Object(r["y"])([]),D=Object(r["y"])(!1),M=function(e){D.value=!1},C=function(){if(null!=o.value&&null!=v.value&&x.value.trim()&&v.value.readyState===v.value.OPEN){var e={uuid:o.value.customer.uuid,message:x.value};try{v.value.send(JSON.stringify(e)),x.value=""}catch(t){console.error("errr")}}},P=function(){var e=Object(L["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t.message.includes("[[処方提案]]")){e.next=5;break}return alert("処方提案うけたよ"),e.next=4,l();case 4:o.value=e.sent;case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();Object(r["q"])(Object(L["a"])(regeneratorRuntime.mark((function e(){var t,r,a,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,l();case 2:return o.value=e.sent,e.next=5,O();case 5:if(S.value=e.sent,null!=o.value){e.next=8;break}return e.abrupt("return");case 8:return 3!=o.value.status&&c.replace({name:"DiagnosticTop"}),e.prev=9,e.next=12,p(o.value.id);case 12:a=e.sent,b.value=a,e.next=20;break;case 16:return e.prev=16,e.t0=e["catch"](9),console.error(e.t0.response),e.abrupt("return");case 20:s="".concat(h,"/chat/doctor/").concat(null===(t=o.value)||void 0===t?void 0:t.customer.uuid,"/?token=").concat(null===(r=n.value)||void 0===r?void 0:r.access),k(s,b,P),window.setTimeout((function(){m()}),100);case 23:case"end":return e.stop()}}),e,null,[[9,16]])})))),Object(r["o"])((function(){f()}));var z=function(e){return E()(e).format("yyyy/MM/DD")},A=function(){var e=Object(L["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,u();case 2:e.sent,c.push({name:"DiagnosticTop"});case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return{myPrescript:o,connection:v,router:c,messageArea:g,message:x,chatLogs:b,onSendMessage:C,wsState:w,wsStateStr:y,getDate:z,onSelectTemplate:M,customerMessageTemplates:S,showMessageTemplates:D,onAcceptPrescriptProducts:A}}});c("7d01");q.render=P,q.__scopeId="data-v-2fc66ddb";t["default"]=q},"6eee":function(e,t,c){},"7d01":function(e,t,c){"use strict";c("6eee")},"8f75":function(e,t,c){"use strict";c.d(t,"a",(function(){return l}));c("96cf");var r=c("1da1"),a=c("7a23"),n=c("2e44"),s=function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t,c,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,n["a"].get("/doctors/");case 2:return t=e.sent,c=t.data,r=c.results,e.abrupt("return",r);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),o=function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t){var c,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,n["a"].get("/doctor/".concat(t));case 2:return c=e.sent,r=c.data,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();function l(){var e=Object(a["y"])([]),t=Object(a["y"])(null);return{doctor:t,doctors:e,getDoctor:o,fetchDoctors:s}}}}]);
//# sourceMappingURL=DoctorDetailChat.a809e9a0.js.map